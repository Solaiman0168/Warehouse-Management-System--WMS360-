
{{--<table id="datatable" class="table table-bordered">--}}
{{--    <thead>--}}
{{--    <tr>--}}
{{--        <th>ID</th>--}}
{{--        <th>Image</th>--}}
{{--        <th>SKU</th>--}}
{{--        <th>Variation</th>--}}
{{--        <th>EAN</th>--}}
{{--        <th>Sold</th>--}}
{{--        <th>Actual Qty</th>--}}
{{--        <th>Total Qty</th>--}}
{{--        <th>Low Quantity</th>--}}
{{--        <th>Catalogue</th>--}}
{{--        <th>Actions</th>--}}


{{--        <th class="id" style="width: 7%; text-align: center !important;">--}}
{{--            <div class="d-flex justify-content-center">--}}
{{--                <div class="btn-group">--}}
{{--                    <form>--}}
{{--                        <a type="button" class="dropdown-toggle filter-btn " data-toggle="dropdown">--}}
{{--                            <i class="fa" aria-hidden="true"></i>--}}
{{--                        </a>--}}
{{--                        <div class="dropdown-menu filter-content shadow" role="menu">--}}
{{--                            <p>Filter Value</p>--}}
{{--                            <input type="text" class="form-control input-text">--}}
{{--                            <div class="checkbox checkbox-custom checkbox m-t-10 m-b-10">--}}
{{--                                <input id="opt-out1" type="checkbox" name="opt-out1" ><label for="opt-out1">Opt Out</label>--}}
{{--                            </div>--}}
{{--                            <button type="submit" class="btn btn-primary filter-apply-btn float-right">Apply <i class="fa fa-arrow-circle-right ml-1"></i></button>--}}
{{--                        </div>--}}
{{--                    </form>--}}
{{--                </div>--}}
{{--                <div>ID</div>--}}
{{--            </div>--}}
{{--        </th>--}}
{{--        <th class="image" style="text-align: center !important;">Image</th>--}}
{{--        <th class="catalogue">--}}
{{--            <div class="d-flex justify-content-start">--}}
{{--                <div class="btn-group">--}}
{{--                    <form>--}}
{{--                        <a type="button" class="dropdown-toggle filter-btn " data-toggle="dropdown">--}}
{{--                            <i class="fa" aria-hidden="true"></i>--}}
{{--                        </a>--}}
{{--                        <div class="dropdown-menu filter-content shadow" role="menu">--}}
{{--                            <p>Filter Value</p>--}}
{{--                            <input type="text" class="form-control input-text">--}}
{{--                            <div class="checkbox checkbox-custom checkbox m-t-10 m-b-10">--}}
{{--                                <input id="opt-out2" type="checkbox" name="opt-out2" ><label for="opt-out2">Opt Out</label>--}}
{{--                            </div>--}}
{{--                            <button type="submit" class="btn btn-primary filter-apply-btn float-right">Apply <i class="fa fa-arrow-circle-right ml-1"></i></button>--}}
{{--                        </div>--}}
{{--                    </form>--}}
{{--                </div>--}}
{{--                <div>Title</div>--}}
{{--            </div>--}}
{{--        </th>--}}
{{--        <th class="sku" style="text-align: center !important;">--}}
{{--            <div class="d-flex justify-content-start">--}}
{{--                <div class="btn-group">--}}
{{--                    <form>--}}
{{--                        <a type="button" class="dropdown-toggle filter-btn " data-toggle="dropdown">--}}
{{--                            <i class="fa" aria-hidden="true"></i>--}}
{{--                        </a>--}}
{{--                        <div class="dropdown-menu filter-content shadow" role="menu">--}}
{{--                            <p>Filter Value</p>--}}
{{--                            <input type="text" class="form-control input-text">--}}
{{--                            <div class="checkbox checkbox-custom checkbox m-t-10 m-b-10">--}}
{{--                                <input id="opt-out3" type="checkbox" name="opt-out3" ><label for="opt-out3">Opt Out</label>--}}
{{--                            </div>--}}
{{--                            <button type="submit" class="btn btn-primary filter-apply-btn float-right">Apply <i class="fa fa-arrow-circle-right ml-1"></i></button>--}}
{{--                        </div>--}}
{{--                    </form>--}}
{{--                </div>--}}
{{--                <div>SKU</div>--}}
{{--            </div>--}}
{{--        </th>--}}
{{--        <th class="variation">--}}
{{--            <div class="d-flex justify-content-start">--}}
{{--                <div class="btn-group">--}}
{{--                    <form>--}}
{{--                        <a type="button" class="dropdown-toggle filter-btn " data-toggle="dropdown">--}}
{{--                            <i class="fa" aria-hidden="true"></i>--}}
{{--                        </a>--}}
{{--                        <div class="dropdown-menu filter-content shadow" role="menu">--}}
{{--                            <p>Filter Value</p>--}}
{{--                            <input type="text" class="form-control input-text">--}}
{{--                            <div class="checkbox checkbox-custom checkbox m-t-10 m-b-10">--}}
{{--                                <input id="opt-out4" type="checkbox" name="opt-out4" ><label for="opt-out4">Opt Out</label>--}}
{{--                            </div>--}}
{{--                            <button type="submit" class="btn btn-primary filter-apply-btn float-right">Apply <i class="fa fa-arrow-circle-right ml-1"></i></button>--}}
{{--                        </div>--}}
{{--                    </form>--}}
{{--                </div>--}}
{{--                <div>Variation</div>--}}
{{--            </div>--}}
{{--        </th>--}}
{{--        <th class="ean">--}}
{{--            <div class="d-flex justify-content-start">--}}
{{--                <div class="btn-group">--}}
{{--                    <form>--}}
{{--                        <a type="button" class="dropdown-toggle filter-btn " data-toggle="dropdown">--}}
{{--                            <i class="fa" aria-hidden="true"></i>--}}
{{--                        </a>--}}
{{--                        <div class="dropdown-menu filter-content shadow" role="menu">--}}
{{--                            <p>Filter Value</p>--}}
{{--                            <input type="text" class="form-control input-text">--}}
{{--                            <div class="checkbox checkbox-custom checkbox m-t-10 m-b-10">--}}
{{--                                <input id="opt-out5" type="checkbox" name="opt-out5" ><label for="opt-out5">Opt Out</label>--}}
{{--                            </div>--}}
{{--                            <button type="submit" class="btn btn-primary filter-apply-btn float-right">Apply <i class="fa fa-arrow-circle-right ml-1"></i></button>--}}
{{--                        </div>--}}
{{--                    </form>--}}
{{--                </div>--}}
{{--                <div>EAN</div>--}}
{{--            </div>--}}
{{--        </th>--}}
{{--        <th class="sold filter-symbol" style="width: 10% !important; text-align: center !important;">--}}
{{--            <div class="d-flex justify-content-center">--}}
{{--                <div class="btn-group">--}}
{{--                    <form>--}}
{{--                        <a type="button" class="dropdown-toggle filter-btn " data-toggle="dropdown">--}}
{{--                            <i class="fa" aria-hidden="true"></i>--}}
{{--                        </a>--}}
{{--                        <div class="dropdown-menu filter-content stock-filter-content shadow" role="menu">--}}
{{--                            <p>Filter Value</p>--}}
{{--                            <div class="d-flex">--}}
{{--                                <div>--}}
{{--                                    <select class="form-control select2">--}}
{{--                                        <option value="">=</option>--}}
{{--                                        <option value=""><</option>--}}
{{--                                        <option value="">></option>--}}
{{--                                        <option value="">≤</option>--}}
{{--                                        <option value="">≥</option>--}}
{{--                                    </select>--}}
{{--                                </div>--}}
{{--                                <div class="ml-2">--}}
{{--                                    <input type="text" class="form-control input-text symbol-filter-input-text" checked>--}}
{{--                                </div>--}}
{{--                            </div>--}}
{{--                            <div class="checkbox checkbox-custom checkbox m-t-10 m-b-10">--}}
{{--                                <input id="opt-out6" type="checkbox" name="opt-out6" ><label for="opt-out6">Opt Out</label>--}}
{{--                            </div>--}}
{{--                            <button type="submit" class="btn btn-primary filter-apply-btn float-right">Apply <i class="fa fa-arrow-circle-right ml-1"></i></button>--}}
{{--                        </div>--}}
{{--                    </form>--}}
{{--                </div>--}}
{{--                <div>Sold</div>--}}
{{--            </div>--}}
{{--        </th>--}}
{{--        <th class="available-qty filter-symbol" style="width: 15% !important; text-align: center !important;">--}}
{{--            <div class="d-flex justify-content-center">--}}
{{--                <div class="btn-group">--}}
{{--                    <form>--}}
{{--                        <a type="button" class="dropdown-toggle filter-btn " data-toggle="dropdown">--}}
{{--                            <i class="fa" aria-hidden="true"></i>--}}
{{--                        </a>--}}
{{--                        <div class="dropdown-menu filter-content stock-filter-content shadow" role="menu">--}}
{{--                            <p>Filter Value</p>--}}
{{--                            <div class="d-flex">--}}
{{--                                <div>--}}
{{--                                    <select class="form-control select2">--}}
{{--                                        <option value="">=</option>--}}
{{--                                        <option value=""><</option>--}}
{{--                                        <option value="">></option>--}}
{{--                                        <option value="">≤</option>--}}
{{--                                        <option value="">≥</option>--}}
{{--                                    </select>--}}
{{--                                </div>--}}
{{--                                <div class="ml-2">--}}
{{--                                    <input type="text" class="form-control input-text symbol-filter-input-text" checked>--}}
{{--                                </div>--}}
{{--                            </div>--}}
{{--                            <div class="checkbox checkbox-custom checkbox m-t-10 m-b-10">--}}
{{--                                <input id="opt-out7" type="checkbox" name="opt-out7" ><label for="opt-out7">Opt Out</label>--}}
{{--                            </div>--}}
{{--                            <button type="submit" class="btn btn-primary filter-apply-btn float-right">Apply <i class="fa fa-arrow-circle-right ml-1"></i></button>--}}
{{--                        </div>--}}
{{--                    </form>--}}
{{--                </div>--}}
{{--                <div>Available Qty</div>--}}
{{--            </div>--}}
{{--        </th>--}}
{{--        <th class="shelf-qty filter-symbol" style="width: 10% !important; text-align: center !important;">--}}
{{--            <div class="d-flex justify-content-center">--}}
{{--                <div class="btn-group">--}}
{{--                    <form>--}}
{{--                        <a type="button" class="dropdown-toggle filter-btn" data-toggle="dropdown">--}}
{{--                            <i class="fa" aria-hidden="true"></i>--}}
{{--                        </a>--}}
{{--                        <div class="dropdown-menu filter-content stock-filter-content shadow" role="menu">--}}
{{--                            <p>Filter Value</p>--}}
{{--                            <div class="d-flex">--}}
{{--                                <div>--}}
{{--                                    <select class="form-control select2">--}}
{{--                                        <option value="">=</option>--}}
{{--                                        <option value=""><</option>--}}
{{--                                        <option value="">></option>--}}
{{--                                        <option value="">≤</option>--}}
{{--                                        <option value="">≥</option>--}}
{{--                                    </select>--}}
{{--                                </div>--}}
{{--                                <div class="ml-2">--}}
{{--                                    <input type="text" class="form-control input-text symbol-filter-input-text" checked>--}}
{{--                                </div>--}}
{{--                            </div>--}}
{{--                            <div class="checkbox checkbox-custom checkbox m-t-10 m-b-10">--}}
{{--                                <input id="opt-out8" type="checkbox" name="opt-out8" ><label for="opt-out8">Opt Out</label>--}}
{{--                            </div>--}}
{{--                            <button type="submit" class="btn btn-primary filter-apply-btn float-right">Apply <i class="fa fa-arrow-circle-right ml-1"></i></button>--}}
{{--                        </div>--}}
{{--                    </form>--}}
{{--                </div>--}}
{{--                <div>Shelf Qty</div>--}}
{{--            </div>--}}
{{--        </th>--}}
{{--        <th class="low-qty filter-symbol" style="width: 10% !important; text-align: center !important;">--}}
{{--            <div class="d-flex justify-content-center">--}}
{{--                <div class="btn-group">--}}
{{--                    <form>--}}
{{--                        <a type="button" class="dropdown-toggle filter-btn" data-toggle="dropdown">--}}
{{--                            <i class="fa" aria-hidden="true"></i>--}}
{{--                        </a>--}}
{{--                        <div class="dropdown-menu filter-content stock-filter-content shadow" role="menu">--}}
{{--                            <p>Filter Value</p>--}}
{{--                            <div class="d-flex">--}}
{{--                                <div>--}}
{{--                                    <select class="form-control select2">--}}
{{--                                        <option value="">=</option>--}}
{{--                                        <option value=""><</option>--}}
{{--                                        <option value="">></option>--}}
{{--                                        <option value="">≤</option>--}}
{{--                                        <option value="">≥</option>--}}
{{--                                    </select>--}}
{{--                                </div>--}}
{{--                                <div class="ml-2">--}}
{{--                                    <input type="text" class="form-control input-text symbol-filter-input-text" checked>--}}
{{--                                </div>--}}
{{--                            </div>--}}
{{--                            <div class="checkbox checkbox-custom checkbox m-t-10 m-b-10">--}}
{{--                                <input id="opt-out9" type="checkbox" name="opt-out9" ><label for="opt-out9">Opt Out</label>--}}
{{--                            </div>--}}
{{--                            <button type="submit" class="btn btn-primary filter-apply-btn float-right">Apply <i class="fa fa-arrow-circle-right ml-1"></i></button>--}}
{{--                        </div>--}}
{{--                    </form>--}}
{{--                </div>--}}
{{--                <div>Low Qty</div>--}}
{{--            </div>--}}
{{--        </th>--}}
{{--        <th class="actions">Actions</th>--}}


{{--    </tr>--}}
{{--    </thead>--}}
{{--    <tbody>--}}
    @foreach($search_result as $search_result)
        <tr>
{{--            <td>{!! str_limit(strip_tags($search_result->description),$limit = 10,$end='...') !!}</td>--}}
            @if($search_result->image != null)
                <td class="image text-center"><img class="product-img" src="{{$search_result->image}}" height="60" width="60" alt="Responsive image"></td>
            @elseif(isset($search_result->product_draft->product_catalogue_image->image_url))
                <td class="image text-center"><a href="{{$search_result->product_draft->product_catalogue_image->image_url}}" target="_blank"><img class="product-img" src="{{$search_result->product_draft->product_catalogue_image->image_url}}" height="60" width="60" alt="Responsive image"></a></td>
            @else
                <td class="image text-center"><img class="product-img" src="{{asset('assets/images/users/no_image.jpg')}}" height="60" width="60" alt="Responsive image"></td>
            @endif
            <td class="id" style="width: 7%; text-align: center !important;">{{$search_result->id}}</td>
            <td class="catalogue"><a href="{{route('product-draft.show',$search_result->product_draft->id)}}" title="View Details" target="_blank">{{$search_result->product_draft->name}}</a></td>
            <td class="sku" style="text-align: center !important;">{{$search_result->sku}}</td>
{{--            @if($search_result->barcode)--}}
{{--                <td><a href="{{asset('barcode/'.$search_result->barcode)}}" download="" title="click to dowmload"><img src="{{asset('barcode/'.$search_result->barcode)}}" alt="sku barcode"></a>--}}
{{--                    <span style="position: absolute;"><a href="{{url('print-barcode/'.$search_result->id)}}" target="_blank"><i class="fa fa-print"></i></a></span>--}}
{{--                </td>--}}
{{--            @else--}}
{{--                <td><a href="{{url('print-barcode/'.$search_result->id)}}" class="btn btn-success btn-sm" title="Click to print" target="_blank">Print Barcode</a></td>--}}
{{--            @endif--}}
            <td class="variation">
                @isset($search_result->attribute)
                    @foreach(\Opis\Closure\unserialize($search_result->attribute) as $attribute)
                    <label><b style="color: #7e57c2">{{$attribute['attribute_name']}}</b> <i class="fa fa-long-arrow-right" aria-hidden="true"></i> {{$attribute['terms_name']}}, </label>
                    @endforeach
                @endisset
            </td>
            @php
                $total_sold = 0;
                 foreach ($search_result->order_products as $product){
                     $total_sold += $product->sold;
                 }
            @endphp
            <td class="ean">{{$search_result->ean_no}}</td>
            <td class="sold" style="width: 10% !important; text-align: center !important;">{{$total_sold ?? 0}}</td>
            <td class="available-qty" style="width: 15% !important; text-align: center !important;">{{$search_result->actual_quantity}}</td>
            @php
                $data = 0;
            @endphp
            @foreach($search_result->shelf_quantity as $total)
                @php
                    $data += $total->pivot->quantity;
                @endphp
            @endforeach
            @if($search_result->notification_status == 1 && $data < $search_result->low_quantity)
                <td class="shelf-qty" style="width: 10% !important; text-align: center !important;">{{$data}}<br><span class="label label-table label-danger">Low Quantity {{$search_result->low_quantity}}</span></td>
            @else
                <td class="shelf-qty" style="width: 10% !important; text-align: center !important;">{{$data}}</td>
            @endif
            <td class="low-qty">{{$search_result->low_quantity}}</td>
            <td class="actions">
                <!--action button-->
                <div class="btn-group dropup">
                    <button type="button" class="btn manage-btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Manage
                    </button>
                    <div class="dropdown-menu">
                        <!-- Dropdown menu links -->
                        <div class="dropup-content">
                            <div class="d-flex justify-content-start">
                                <div class="align-items-center mr-2"><a class="btn-size edit-btn" href="{{route('product-variation.edit',$search_result->id)}}" data-toggle="tooltip" data-placement="top" title="Edit"><i class="fa fa-edit" aria-hidden="true"></i></a></div>
                                <div class="align-items-center mr-2"><a class="btn-size view-btn" href="{{url('variation-details/'.Crypt::encrypt($search_result->id))}}" data-toggle="tooltip" data-placement="top" title="View"><i class="fa fa-eye" aria-hidden="true"></i></a></div>
                                <div class="align-items-center mr-2" data-toggle="tooltip" data-placement="top" title="Shelf View"><a class="btn-size shelf-btn" href="#" data-toggle="modal" data-target="#myModal{{$search_result->id}}"><i class="fa fa-shopping-basket"></i></a></div>
                                <div class="align-items-center mr-2"><a class="btn-size invoice-btn invoice-btn-size" href="{{url('catalogue-product-invoice-receive/'.$search_result->product_draft->id.'/'.$search_result->id)}}" target="_blank" data-toggle="tooltip" data-placement="top" title="Receive Invoice"><img src="{{asset('assets/images/receive-invoice.png')}}" width="30" height="30" class="filter"></a></div>
                                <div class="align-items-center mr-2"><a class="btn-size print-btn" href="{{url('print-barcode/'.$search_result->id)}}" data-toggle="tooltip" data-placement="top" title="Click to print" target="_blank"><i class="fa fa-print"></i></a></div>
                                <div class="align-items-center">
                                    <form action="{{route('product-variation.destroy',$search_result->id)}}" method="post">
                                        @csrf
                                        @method('DELETE')
                                        <button class="del-pub delete-btn on-default remove-row" style="cursor: pointer" onclick="return check_delete('product');" data-toggle="tooltip" data-placement="top" title="Delete"><i class="fa fa-trash" aria-hidden="true"></i> </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </td>
            <div class="modal fade" id="myModal{{$search_result->id}}">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">

                        <!-- Modal Header -->
                        <div class="modal-header">
                            <h4 class="modal-title">Shelf Product</h4>
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                        </div>

                        <!-- Modal body -->
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="p-2 m-t-5 m-b-5 m-l-5 m-r-5">
                                        <div class="border">
                                            <div class="row m-t-10">
                                                <div class="col-md-6 col-sm-6 text-center">
                                                    <h6> Shelf Name </h6>
                                                    <hr width="60%">
                                                </div>
                                                <div class="col-md-6 col-sm-6 text-center">
                                                    <h6>Quantity</h6>
                                                    <hr width="60%">
                                                </div>
                                            </div>
                                            @foreach($search_result->shelf_quantity as $shelf)
                                                @if($shelf->pivot->quantity != 0)
                                                    <div class="row">
                                                        <div class="col-md-6 col-sm-6 text-center">
                                                            <h7> {{$shelf->shelf_name}} </h7>
                                                        </div>
                                                        <div class="col-md-6 col-sm-6 text-center">
                                                            <h7> {{$shelf->pivot->quantity}} </h7>
                                                        </div>
                                                    </div>
                                                @endif
                                            @endforeach
                                        </div>
                                    </div> <!-- end card -->
                                </div> <!-- end col-12 -->
                            </div> <!-- end row -->
                        </div>

                        <!-- Modal footer -->
                        <div class="modal-footer">
                            <button type="button" class="btn btn-danger shadow" data-dismiss="modal">Close</button>
                        </div>

                    </div>
                </div>
            </div>  <!-- // The Modal -->
        </tr>
    @endforeach
{{--    </tbody>--}}
{{--</table>--}}



<script>

    // table column hide and show toggle checkbox
    $("input:checkbox").click(function(){
        let column = "."+$(this).attr("name");
        $(column).toggle();
    });




    // table column hide and show toggle checkbox
    $("input:checkbox").click(function(){
        let column = "."+$(this).attr("name");
        $(column).toggle();
    });

    //table column by default hide
    $("input:checkbox:not(:checked)").each(function() {
        var column = "table ." + $(this).attr("name");
        $(column).hide();
    });

    //prevent onclick dropdown menu close
    $('.filter-content').on('click', function(event){
        event.stopPropagation();
    });

</script>
